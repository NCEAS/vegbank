<?xml version="1.0"?>
<!-- 
  * build.xml
  *
  *	Authors: John Harris
  *	Copyright: 2000 Regents of the University of California and the
  *	National Center for Ecological Analysis and Synthesis
  *	Build file for the Ant cross-platform build system for metacat
  *	See http://jakarta.apache.org for details on Ant  
  *  
  * This build file will build the plant taxonomy database
  * software and insert a small test data set into the 
  * resulting database.  The test data set is stems from the 
  * 1996 and 2000 usda plants list and the test dataset 
  * (at this point contains data for the Juglandacea, Pineacea
  * and the Aster Genre) 
  *
  * usage: ant [compile|jar|install|jdoc]
--> 
<project name="plotLoader" default="dist" basedir=".">

<target name="init">
	<tstamp/>
	
	<property name="current" value="./" />
	<property name="db_prop_file" value="./database.properties" />
	<property name="build" value="build" />
	<property name="build_bin" value="${build}/bin" />
	<property name="build_lib" value="${build}/lib" />
	<property name="build_src" value="${build}/src" />
	<property name="build_data" value="${build}/data" />
	<property name="release" value="development"/>
	<filter token="version" value="development"/>
	<property name="data" value="./taxaData"/>
	<property name="src" value="./src"/>
	<property name="bin" value="./bin"/>
	<property name="sql" value="./sql"/>
	<property name="xmlFiles" value="./xmlfiles"/>
	<filter token="dist" value="dist"/>
	<property name="toolsdir" value="/usr/local/devtools" />
	<property name="localToolsDir" value="/home/computer/harris/tools" />	
	<property name="xmlp" value="${localToolsDir}/xmlTools/xalan.jar:${localToolsDir}/xmlTools/xerces.jar:" />
	<property name="jdbc" value="${oracle_home}/jdbc/lib/classes111.zip" />
	<property name="multipart" value="./servlet/multipart" />
	<property name="cpath" value="${xmlp}:${jdbc}:${build}:${localToolsDir}:./"/>			

</target>




<target name="prepare" depends="init">
	<mkdir dir="${build}" />
	<mkdir dir="${build_bin}" />
	<mkdir dir="${build_src}" />
	<mkdir dir="${build_lib}" />
	<mkdir dir="${build_data}" />


	<copydir src="${src}" 
		dest="${build_src}" 
		filtering="yes"
		includes="**.java "
		excludes="**/CVS*"
	/>
	<copydir src="${xmlFiles}"
	  dest="${build_src}"
		filtering="yes"
		includes="**.dtd **.xsl "
		excludes="**/CVS*"
	/>
										
	<copy file="${db_prop_file}" 
		todir="${build_src}"/>
	
	
	<copydir src="${bin}"
		dest="${build_bin}"
		filtering="yes"
		includes="**"	
	/>
	<chmod dir="${build_bin}"
		perm="a+x"
		includes="**/*.sh"
	/>
						
	<copydir src="${data}"
		dest="${build_data}"
		filtering="yes"
		includes="plantlst1996.bin plantlst2000.bin "
	/>

<copydir src="${sql}"
	dest="${build_lib}"
	filtering="yes"
	includes="createPlantNameDBed.sql denormalize.sql"
/>
							


</target>	



	
<target name="compile" depends="prepare">
	<javac srcdir="${build_src}" 
		classpath="${cpath}"
		includes="USDAPlantsToXml.java USDAPlantsLoader.java USDAPlantsLoader2000.java" 
		destdir="${build_src}"
	/>
</target>	

	
<target name="dist" depends="compile">

<!--	
	<mkdir dir="${dist}/lib" />
	<deltree dir="${dist}" />
-->	

	<jar jarfile ="${build_lib}/PlantTaxonomy.jar"
		basedir="${build_src}"
		includes="${build_src}/ **.class **.dtd **.xsl  **.properties"
	/>
</target>		



</project>
