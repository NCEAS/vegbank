###############################################
# Convenient shortcuts to common site content.
#       
# $Id: .htaccess,v 1.16 2005-06-23 14:15:55 mlee Exp $
###############################################

RewriteEngine  on

#### Plot Search
# NC = No Case match, so case insensitive match
# QSA = Query String Append
# L = Last rewrite rule to do, so stop here
RewriteRule ^plotsearch$      @plotquery_page_advanced@   [NC,QSA,L]

#### Vegdocs Links
## The cool general case one doesn't work yet
#RewriteCond %{REQUEST_URI}  ^/workshop
  #  ADD OTHER VEGDOCS SHORTCUTS HERE
#RewriteRule ^(.+)$      /vegdocs/$1   [NC,QSA, L]

## But this direct link to workshop does
RewriteRule ^workshop$      /vegdocs/workshop  [NC,QSA,L]

RewriteRule ^forgotpassword$  /vegbank/forms/EmailPassword.jsp [NC,QSA,L]

####################################################################
## VEGBRANCH rewrites (the VegBranch database accesses these: 
####################################################################

RewriteRule ^vegbranch$      /vegdocs/vegbranch/vegbranch.html  [NC,QSA,L,R]
RewriteRule ^terms$          /vegbank/general/terms.html  [NC,QSA,L,R]
RewriteRule ^vegbranch-usda-states$      /vegdocs/vegbranch/client/vbr_usda_stateranges.zip  [NC,QSA,L,R]

RewriteRule ^xml$            /vegdocs/xml/vegbank-xml-index.html  [NC,QSA,L,R]

# Rewrite Example
#RewriteCond %{REQUEST_URI}  ^.+\.html
#RewriteCond %{REQUEST_URI}  !/ignore.html
#RewriteRule ^(.+\.html)     /someAction.do?page=$1   [NC,QSA,L]


## /get
# plots are special case:
RewriteCond %{REQUEST_URI}  ^/get/(.*)/plot/([0-9,]+)
RewriteRule ^get/(.*)/plot/([0-9,]+)      @server_address@/vegbank/GenericDispatcher.do?command=Dispatch&view=$1&entity=observation&params=$2&where=where_plotplot_pk   [NC,QSA,L]
#plots by accessioncode
RewriteCond %{REQUEST_URI}  ^/get/(.*)/plot/(.*)
RewriteRule ^get/(.*)/plot/(.*)      @server_address@/vegbank/GenericDispatcher.do?command=Dispatch&view=$1&entity=observation&params=$2&where=where_plot_ac   [NC,QSA,L]


RewriteCond %{REQUEST_URI}  ^/get/(.*)/(.*)/(.*)
RewriteRule ^get/(.*)/(.*)/(.*)      @server_address@/vegbank/GenericDispatcher.do?command=Dispatch&view=$1&entity=$2&params=$3   [NC,QSA,L]

RewriteCond %{REQUEST_URI}  ^/get/(.*)/(.*)
RewriteRule ^get/(.*)/(.*)      @server_address@/vegbank/GenericDispatcher.do?command=Dispatch&view=$1&entity=$2   [NC,QSA,L]



RewriteRule ^cite/([^\.]+)\.Ob\.(.*)$       @get_link@comprehensive/observation/$1.Ob.$2              [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.Pl\.(.*)$	  @get_link@std/observation/$1.Pl.$2?where=where_plot_ac              [NC,QSA,L] 
RewriteRule ^cite/([^\.]+)\.PC\.(.*)$	  @get_link@std/plantconcept/$1.PC.$2      [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.CC\.(.*)$	  @get_link@std/commconcept/$1.CC.$2       [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.Py\.(.*)$	  @get_link@std/party/$1.Py.$2	       [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.Rf\.(.*)$   @get_link@std/reference/$1.Rf.$2	       [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.RJ\.(.*)$	   @get_link@std/referencejournal/$1.RJ.$2  [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.SM\.(.*)$	   @get_link@std/stratummethod/$1.SM.$2     [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.CM\.(.*)$	   @get_link@std/covermethod/$1.CM.$2       [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.NP\.(.*)$	   @get_link@std/namedplace/$1.NP.$2	       [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.Pj\.(.*)$	   @get_link@std/project/$1.Pj.$2	       [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.ST\.(.*)$	   @get_link@std/soiltaxon/$1.ST.$2	       [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.UD\.(.*)$	   @get_link@std/userdefined/$1.UD.$2       [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.TO\.(.*)$	   @get_link@std/taxonobservation/$1.TO.$2  [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.Cl\.(.*)$	   @get_link@std/commclass/$1.Cl.$2	       [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.RP\.(.*)$	   @get_link@std/referenceparty/$1.RP.$2    [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.AR\.(.*)$	   @get_link@std/aux_role/$1.AR.$2	       [NC,QSA,L]
RewriteRule ^cite/([^\.]+)\.DS\.(.*)$	   @get_link@std/userdataset/$1.DS.$2       [NC,QSA,L]

RewriteRule ^dd/(.*)/(.*)	   @dbdictionary_link@dd~table~$1~field~$2~type~fieldview.html       [NC,QSA,L]
RewriteRule ^dd/(.*)	           @dbdictionary_link@dd~table~$1~type~tableview.html                [NC,QSA,L]

## for deep links FROM natureserve
RewriteRule ^natureserve/(.*)$   @get_link@std/observation/$1?where=where_observation_nsuid   [NC,QSA,L]


## for browsing data
RewriteRule ^browse$	 	   @views_link@topdata.jsp?perPage=5&getonly=0       [NC,QSA,L]
RewriteRule ^browse-byplace$	   @views_link@topdata.jsp?perPage=20&getonly=1       [NC,QSA,L]
RewriteRule ^browse-bycomm$	   @views_link@topdata.jsp?perPage=20&getonly=5       [NC,QSA,L]
RewriteRule ^browse-byparty$	   @views_link@topdata.jsp?perPage=20&getonly=2       [NC,QSA,L]
RewriteRule ^browse-byplant$	   @views_link@topdata.jsp?perPage=20&getonly=4       [NC,QSA,L]
RewriteRule ^browse-byproject$	   @views_link@topdata.jsp?perPage=20&getonly=3       [NC,QSA,L]