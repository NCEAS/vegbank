<?xml version="1.0" encoding="ISO-8859-1" ?>

<!DOCTYPE struts-config PUBLIC
          "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
          "http://jakarta.apache.org/struts/dtds/struts-config_1_1.dtd">

<!--
     This is the Struts configuration file for the example application,
     using the proposed new syntax.
-->


<struts-config>


  <!-- ========== Data Source Configuration =============================== -->

  <!-- ========== Form Bean Definitions =================================== -->
  <form-beans>

    <!-- Vegbank AddReferenceForm form bean -->
    <form-bean  name="AddReferenceForm"
                     type="org.vegbank.ui.struts.AddReferenceForm"/>

    <form-bean  name="AddJournalForm"
                type="org.vegbank.ui.struts.AddJournalForm"/>

    <form-bean  name="AddCoverMethodForm"
                type="org.vegbank.ui.struts.AddCoverMethodForm"/>
  
    <form-bean  name="AddStratumMethodForm"
                type="org.vegbank.ui.struts.AddStratumMethodForm"/>

    <form-bean  name="AddPartyForm"
                type="org.vegbank.ui.struts.AddPartyForm"/>

    <form-bean  name="PlotQueryForm"
                type="org.vegbank.ui.struts.PlotQueryForm"/>
		
    <form-bean  name="EntityNameForm"
                type="org.vegbank.ui.struts.EntityNameForm"/>
		
    <form-bean  name="UploadPlotForm"
                type="org.vegbank.ui.struts.UploadPlotForm"/>

    <!-- DynaActionForms -->
    <form-bean  name="DropPlotForm"
                type="org.apache.struts.action.DynaActionForm">
		<form-property name="plotIdList" type="java.lang.String"/>
    </form-bean>
		
    <form-bean  name="DisplayPlotForm"
                type="org.apache.struts.validator.DynaValidatorForm">
		<form-property name="vegbankAccessionNumber" type="java.lang.String"/>
		<form-property name="resultType" type="java.lang.String"/>
    </form-bean>

    <form-bean  name="DownLoadForm"
                type="org.apache.struts.validator.DynaValidatorForm">
		<form-property name="dataType" type="java.lang.String" initial="all"/>
		<form-property name="formatType" type="java.lang.String" initial="xml"/>
		<form-property name="plotsToDownLoad" type="java.lang.String[]"/>
    </form-bean>

    <form-bean  name="DownLoadManagerForm"
                type="org.apache.struts.validator.DynaValidatorForm">
		<form-property name="plotsToDownLoad" type="java.lang.String[]"/>
    </form-bean>

    <form-bean  name="DisplayQueryResultsForm"
                type="org.apache.struts.validator.DynaValidatorForm">
		<form-property name="plotsToDownLoad" type="java.lang.String[]"/>
    </form-bean>
    
    <!-- Logon form bean -->
    <form-bean       name="LogonForm"
                     type="org.apache.struts.validator.DynaValidatorForm">
      <form-property name="username" type="java.lang.String"/>
      <form-property name="password" type="java.lang.String"/>
    </form-bean>
   
    <!-- Email password form bean -->
    <form-bean  name="EmailPasswordForm"
                type="org.apache.struts.validator.DynaValidatorForm">
		<form-property name="email" type="java.lang.String"/>
    </form-bean>
	
    <!-- Register new user form bean -->
    <form-bean  name="RegisterNewUserForm"
                type="org.apache.struts.validator.DynaValidatorForm">
		<form-property name="user" type="org.vegbank.common.model.Usr"/>
		<form-property name="party" type="org.vegbank.common.model.Party"/>
		<form-property name="address" type="org.vegbank.common.model.Address"/>
		<form-property name="telephone" type="org.vegbank.common.model.Telephone"/>
		<form-property name="termsaccept" type="java.lang.String"/>
		<form-property name="password1" type="java.lang.String"/>
		<form-property name="password2" type="java.lang.String"/>
		<form-property name="statelist" type="org.vegbank.common.model.utility.Statelist"/>
    </form-bean>


  </form-beans>


  <!-- ========== Global Forward Definitions ============================== -->
  <global-forwards>
    <forward   name="Logoff"	path="/forms/Logoff.do"/>
    <forward   name="Logon"	path="/general/login.jsp"/>
    <forward   name="MainMenu"	path="/forms/MainMenu.jsp"/>
    <forward   name="success"	path="/forms/success.html"/>
    <forward   name="failure"	path="/forms/failure.jsp"/>
    <forward   name="AddReference"	path="/forms/AddReference.jsp"/>
    <forward   name="AddJournal"	path="/forms/AddJournal.jsp"/>
    <forward   name="AddCoverMethod"	path="/forms/AddCoverMethod.jsp"/>
    <forward   name="AddStratumMethod"	path="/forms/AddStratumMethod.jsp"/>
    <forward   name="AddParty"	path="/forms/AddParty.jsp"/>
    <forward   name="PlotQuery"	path="/forms/plot-query.jsp"/>
    <forward   name="EntityName"	path="/forms/EntityName.jsp"/>
    <forward   name="DisplayResults" path="/forms/DisplayResults.jsp"/>
    <forward   name="DisplayLoadReport" path="/forms/DisplayLoadReport.jsp"/>
    <forward   name="AuthenticationException" path="/forms/authenticationException.jsp"/>
    <forward   name="CertificationException" path="/forms/CertificationException.jsp"/>
    <forward   name="DisplayUploadPlotAction" path="/forms/plot-submit.jsp"/>
    <forward   name="DropPlotAction" path="/forms/plot-drop.jsp"/>
    <forward   name="DownLoad"	path="/forms/DownLoad.jsp"/>
    <forward   name="DownLoadManager"	path="/DownLoadManager.do"/>
    <forward   name="EmailPassword"	path="/forms/EmailPassword.jsp"/>
    <forward   name="RegisterNewUser"	path="/forms/RegisterNewUser.jsp"/>
  </global-forwards>


  <!-- ========== Action Mapping Definitions ============================== -->
  <action-mappings type="org.vegbank.ui.struts.VegbankActionMapping">

    <!-- Process a user logon -->
    <action path="/Logon"
            type="org.vegbank.ui.struts.LogonAction"
            name="LogonForm"
            validate="true"
            input="Logon">
      <forward name="success" path="/forms/MainMenu.jsp"/>
    </action>

    <!-- Process a user logoff -->
    <action    path="/Logoff"
               type="org.vegbank.ui.struts.LogoffAction">
      <forward name="success" path="/index.jsp"/>
    </action>

    <!-- Display the MainMenu screen --> 
    <action path="/DisplayMainMenu" forward="MainMenu">
      <set-property property="authClass" value="org.vegbank.ui.struts.Authenticate" />
    </action>

    <!-- Display the Plot Upload screen --> 
    <action path="/DisplayUploadPlotAction" forward="/forms/plot-submit.jsp">
      <set-property property="authClass" value="org.vegbank.ui.struts.Authenticate" />
      <set-property property="minCertLevel" value="2" />
    </action>

    <action path="/UploadPlot"
	type="org.vegbank.ui.struts.UploadPlotAction"
        name="UploadPlotForm"
        scope="request"
        validate="true"
        input="DisplayUploadPlotAction">
    </action>		 

    <action path="/DropPlot"
	type="org.vegbank.ui.struts.DropPlotAction"
        name="DropPlotForm"
        scope="request"
        validate="true"
        input="DropPlotAction">
    </action>		 

	<!-- Add a reference to vegbank -->
    <action    path="/AddReference"
    	  type="org.vegbank.ui.struts.AddReferenceAction"
     	  name="AddReferenceForm"
      	scope="request"
      	validate="true"
      	input="AddReference">
    </action>

    <action    path="/AddCoverMethod"
    	  type="org.vegbank.ui.struts.AddCoverMethodAction"
     	  name="AddCoverMethodForm"
      	scope="request"
      	validate="true"
      	input="AddCoverMethod">
    </action>

    <action    path="/AddStratumMethod"
    	  type="org.vegbank.ui.struts.AddStratumMethodAction"
     	  name="AddStratumMethodForm"
      	scope="request"
      	validate="true"
      	input="AddStratumMethod">
    </action>


    <action    path="/AddJournal"
    	  type="org.vegbank.ui.struts.AddJournalAction"
     	  name="AddJournalForm"
      	scope="request"
      	validate="true"
      	input="AddJournal">
    </action>

    <action    path="/AddParty"
    	  type="org.vegbank.ui.struts.AddPartyAction"
     	  name="AddPartyForm"
      	scope="request"
      	validate="true"
      	input="AddParty">
    </action>


    <action path="/PlotQuery"
    	  type="org.vegbank.ui.struts.PlotQueryAction"
     	  name="PlotQueryForm"
      	scope="request"
      	validate="true"
      	input="PlotQuery">
    </action>

    <!-- Display a plot -->
    <action path="/DisplayPlot"
        type="org.vegbank.ui.struts.DisplayPlotAction"
        name="DisplayPlotForm"
        scope="request"
        validate="true"
	input="failure">
    </action>

    <!-- Manage file download -->
    <action path="/DownLoadManager"
        type="org.vegbank.ui.struts.DownLoadManagerAction"
        name="DownLoadManagerForm"
        scope="request"
        validate="true"
	input="DisplayResults">
      <forward name="success" path="/forms/DownLoad.jsp"/>
    </action>

    <!-- Download a file -->
    <action path="/DownLoad"
        type="org.vegbank.ui.struts.DownLoadAction"
        name="DownLoadForm"
        scope="request"
        validate="true"
	input="DownLoad">
    </action>



    <action path="/EntityName"
    	  type="org.vegbank.ui.struts.EntityNameAction"
     	  name="EntityNameForm"
      	scope="request"
      	validate="true"
      	input="EntityName">
    </action>

    <action path="/GenericDispatcher"
    	  type="org.vegbank.ui.struts.GenericDispatcherAction"
          scope="request">
    </action>

    <!-- Email the user their password -->
    <action path="/EmailPassword"
            type="org.vegbank.ui.struts.EmailPasswordAction"
            name="EmailPasswordForm"
            scope="request"
            validate="true"
            input="EmailPassword">
      <forward name="success" path="/index.jsp"/>
    </action>

    <!-- Email the user their password -->
    <action path="/RegisterNewUser"
            type="org.vegbank.ui.struts.RegisterNewUserAction"
            name="RegisterNewUserForm"
            scope="request"
            validate="true"
            input="RegisterNewUser">
      <forward name="success" path="/index.jsp"/>
    </action>

  </action-mappings>


  <!-- ========== Controller Configuration ================================ -->

  <controller processorClass="org.vegbank.ui.struts.RequestProcessor">
    <!-- The "input" parameter on "action" elements is the name of a
         local or global "forward" rather than a module-relative path -->
    <set-property property="inputForward" value="true"/>
    <set-property property="maxFileSize" value="20M"/>
  </controller>


  <!-- ========== Message Resources Definitions =========================== -->

  <message-resources
    parameter="org.apache.struts.webapp.example.ApplicationResources"/>

  <!-- ========== Plug Ins Configuration ================================== -->

  <plug-in className="org.apache.struts.plugins.ModuleConfigVerifier"/>

  <plug-in className="org.apache.struts.validator.ValidatorPlugIn">
    <set-property property="pathnames"
                     value="/WEB-INF/validator-rules.xml,
                            /WEB-INF/validation.xml"/>
  </plug-in>

</struts-config>
