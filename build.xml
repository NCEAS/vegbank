<?xml version="1.0"?>
<!-- 
  * build.xml
  *
  * Global build script for vegclass. This simply allows running all the sub 
  * scripts from one place.
  *
  *     '$Author: farrell $'
  *     '$Date: 2003-03-08 00:24:23 $'
  *     '$Revision: 1.5 $'
--> 
<project name="vegclass" default="compile" basedir=".">


  <target name="prepare">
    <property environment="env" />
    <property name="build.dir" value="${basedir}/build"/>
    <property name="reports.dir" value="${build.dir}/reports"/>
    <property name="reports.test.dir" value="${reports.dir}/testreports"/>
    <property name="ant.style.dir" location="${env.ANT_HOME}/etc" />
    <property name="web.docroot" location="${env.TOMCAT_HOME}/webapps" />
        
  </target>
    
  <target name="jar" depends="prepare"
          description=" => Generates all jars in vegclass module">
    
    <ant dir="common" target="jar" inheritAll="false"/>
    <ant dir="veg_plot" target="jar" inheritAll="false"/>
    <ant dir="veg_community" target="jar" inheritAll="false"/>
    <ant dir="veg_taxa" target="jar" inheritAll="false"/>
    
  </target>

  <target name="run-tests" description="==> Run all the tests availible">
    <ant dir="veg_plot" target="run-tests" inheritAll="false"/> 
    <ant dir="common" target="test" inheritAll="false"/>
    <ant dir="veg_taxa" target="test" inheritAll="false"/>
  </target>
  
  <target name="deploy" depends="jar"
          description=" => deploys vegclass module jars, html and other resources">
    
    <ant dir="common" target="deploy" inheritAll="false"/>
    <ant dir="veg_plot" target="deploy" inheritAll="false"/>
    <ant dir="veg_community" target="deploy" inheritAll="false"/>
    <ant dir="veg_taxa" target="deploy" inheritAll="false"/>
  
  </target>

	<target name="clean" description="=> Remove all generated files">
    <ant dir="common" target="clean" inheritAll="false"/>
    <ant dir="veg_plot" target="clean" inheritAll="false"/>
    <ant dir="veg_community" target="clean" inheritAll="false"/>
    <ant dir="veg_taxa" target="clean" inheritAll="false"/>
  </target>

  <target name="dist-reports" 
          depends="prepare"
          description="=> Generate htmls from generated reports and distributes to web">

		<!-- Create a report from the junit output -->
		<junitreport todir="${reports.test.dir}">
	  		<fileset dir="${reports.test.dir}">
	  			<include name="TEST-*.xml"/>
			</fileset>
	  		<report format="frames"
				        todir="${web.docroot}/vegbank/dev/reports/junit"
	              styledir="${ant.style.dir}"/>
	  	</junitreport>
	
	</target>

</project>
